<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Flappy Connecta</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: linear-gradient(to bottom, #87CEEB, #fff);
        font-family: sans-serif;
        touch-action: manipulation; /* evita zoom e scroll em toques */
    }
    canvas {
        display: block;
        margin: 0 auto;
        background: transparent;
        touch-action: manipulation; /* também no canvas */
    }
    #score {
        position: absolute;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 32px;
        font-weight: bold;
        color: red;
        text-shadow: 2px 2px #fff;
    }
    #menu {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        color: white; text-align: center;
    }
    #menu button {
        font-size: 32px;
        padding: 15px 40px;
        background-color: red;
        color: white;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        box-shadow: 3px 3px 6px #000;
    }
</style>
</head>
<body>

<div id="menu">
    <h1>Flappy Connecta</h1>
    <button id="startBtn">Jogar</button>
</div>

<canvas id="gameCanvas" width="400" height="600"></canvas>
<div id="score">0</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let gravity = 0.6;
let lift = -10;
let velocity = 0;
let santaY = canvas.height/2;
let santaX = 50;

let pipes = [];
let pipeWidth = 60;
let pipeGap = 150;
let frame = 0;
let score = 0;

function createPipe() {
    const topHeight = Math.random() * (canvas.height - pipeGap - 50) + 50;
    pipes.push({x: canvas.width, top: topHeight, bottom: topHeight + pipeGap});
}

function checkCollision(pipe) {
    if (santaX + 40 > pipe.x && santaX < pipe.x + pipeWidth &&
        (santaY < pipe.top || santaY + 40 > pipe.bottom)) return true;
    if (santaY + 40 > canvas.height || santaY < 0) return true;
    return false;
}

function gameOver() {
    alert("Game Over! Pontuação: " + score);
    location.reload();
}

function update() {
    frame++;
    velocity += gravity;
    santaY += velocity;

    if (frame % 90 === 0) createPipe();

    for (let i = pipes.length - 1; i >= 0; i--) {
        pipes[i].x -= 2;

        if (pipes[i].x + pipeWidth < 0) {
            pipes.splice(i, 1);
            score++;
            document.getElementById('score').innerText = score;
        }

        if (checkCollision(pipes[i])) {
            gameOver();
            return;
        }
    }

    draw();
    requestAnimationFrame(update);
}

function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Pai Natal
    ctx.fillStyle = 'red';
    ctx.fillRect(santaX, santaY, 40, 40);

    // Pipes
    ctx.fillStyle = 'green';
    for (let pipe of pipes) {
        ctx.fillRect(pipe.x, 0, pipeWidth, pipe.top);
        ctx.fillRect(pipe.x, pipe.bottom, pipeWidth, canvas.height - pipe.bottom);
    }
}

function flap() {
    velocity = lift;
}

// Controles: toque no ecrã ou clique
canvas.addEventListener('touchstart', flap);
canvas.addEventListener('mousedown', flap);
document.addEventListener('keydown', flap); // opcional para PC

document.getElementById('startBtn').addEventListener('click', () => {
    document.getElementById('menu').style.display = 'none';
    update();
});
</script>

</body>
</html>
